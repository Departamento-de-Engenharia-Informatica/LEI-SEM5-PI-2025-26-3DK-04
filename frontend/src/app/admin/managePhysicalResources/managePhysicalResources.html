<section class="manage-physical-resources">
  <div class="container">
    <h1>{{ t('managePhysicalResources.title') }}</h1>

    <!-- ========== FILTERS ========== -->
    <div class="filters-section">
      <h3>{{ t('managePhysicalResources.filtersTitle') }}</h3>

      <div class="filter-group">
        <label>{{ t('managePhysicalResources.descriptionFilter') }}</label>
        <input type="text"
               [(ngModel)]="filterDescription"
               (input)="applyFilter()"
               placeholder="{{ t('managePhysicalResources.descriptionPlaceholder') }}">
      </div>

      <div class="filter-group">
        <label>{{ t('managePhysicalResources.typeFilter') }}</label>
        <input type="text"
               [(ngModel)]="filterType"
               (input)="applyFilter()"
               placeholder="{{ t('managePhysicalResources.typePlaceholder') }}">
      </div>

      <div class="filter-buttons">
        <button (click)="applyFilter()">{{ t('adminUI.filter') }}</button>
        <button class="secondary" (click)="clearFilter()">{{ t('adminUI.clear') }}</button>
      </div>
    </div>

    <!-- ========== TABLE ========== -->
    <table *ngIf="resources.length > 0">
      <thead>
      <tr>
        <th>{{ t('managePhysicalResources.description') }}</th>
        <th>{{ t('managePhysicalResources.type') }}</th>
        <th>{{ t('managePhysicalResources.capacity') }}</th>
        <th>{{ t('managePhysicalResources.assignedArea') }}</th>
        <th>{{ t('managePhysicalResources.setupTime') }}</th>
        <th>{{ t('managePhysicalResources.status') }}</th>
        <th>{{ t('managePhysicalResources.qualifications') }}</th>
        <th>{{ t('actions') }}</th>
      </tr>
      </thead>

      <tbody>
      <tr *ngFor="let r of resources">
        <td>{{ r.description }}</td>
        <td>{{ r.type }}</td>
        <td>{{ r.capacity }}</td>
        <td>{{ r.assignedArea }}</td>
        <td>{{ r.setupTime }}</td>

        <td>
            <span class="status-badge"
                  [ngClass]="{
                'active': r.status === 'Active',
                'inactive': r.status === 'Inactive',
                'maintenance': r.status === 'Maintenance'
              }">
              {{ r.status }}
            </span>
        </td>

        <td>
          <div *ngFor="let q of r.qualificationIds">
            {{ getQualificationName(q) }}
          </div>
        </td>

        <td>
          <button (click)="editResource(r)">{{ t('edit') }}</button>
          <button class="secondary" (click)="openChangeStatusDialog(r)">
            {{ t('managePhysicalResources.changeStatus') }}
          </button>
        </td>
      </tr>
      </tbody>
    </table>

    <!-- ========== FORM ========== -->
    <div class="form-section">
      <h3 *ngIf="!editing">{{ t('managePhysicalResources.createTitle') }}</h3>
      <h3 *ngIf="editing">{{ t('managePhysicalResources.editTitle') }}</h3>

      <div class="form-group">
        <label>{{ t('managePhysicalResources.description') }}</label>
        <input type="text" [(ngModel)]="resourceForm.description">
      </div>

      <div class="form-group">
        <label>{{ t('managePhysicalResources.type') }}</label>
        <input type="text" [(ngModel)]="resourceForm.type" [disabled]="editing">
      </div>

      <div class="form-group">
        <label>{{ t('managePhysicalResources.capacity') }}</label>
        <input type="number" [(ngModel)]="resourceForm.capacity">
      </div>

      <div class="form-group">
        <label>{{ t('managePhysicalResources.assignedArea') }}</label>
        <input type="text" [(ngModel)]="resourceForm.assignedArea">
      </div>

      <div class="form-group">
        <label>{{ t('managePhysicalResources.setupTime') }}</label>
        <input type="number" [(ngModel)]="resourceForm.setupTime">
      </div>

      <div class="form-group" *ngIf="!editing">
        <label>{{ t('managePhysicalResources.status') }}</label>
        <select [(ngModel)]="resourceForm.status">
          <option *ngFor="let s of statusOptions" [value]="s">{{ s }}</option>
        </select>
      </div>

      <div class="form-group">
        <label>{{ t('managePhysicalResources.qualifications') }}</label>

        <div class="qualification-item" *ngFor="let q of qualifications">
          <input type="checkbox"
                 [value]="q.id"
                 (change)="onQualificationChange($event)"
                 [checked]="resourceForm.qualificationIds.includes(q.id)">
          <span>{{ q.name }}</span>
        </div>
      </div>

      <div class="form-buttons">
        <button (click)="saveResource()">
          {{ editing ? t('saveChanges') : t('create') }}
        </button>

        <button class="secondary" (click)="resetForm()">
          {{ t('clear') }}
        </button>
      </div>
    </div>
  </div>

  <!-- ========== STATUS MODAL ========== -->
  <div class="modal-backdrop" *ngIf="statusModalOpen">
    <div class="modal-box">
      <h3>{{ t('managePhysicalResources.changeStatusTitle') }}</h3>

      <select [(ngModel)]="statusSelected">
        <option *ngFor="let s of statusOptions" [value]="s">{{ s }}</option>
      </select>

      <div class="modal-buttons">
        <button (click)="confirmChangeStatus()">
          {{ t('confirm') }}
        </button>

        <button class="secondary" (click)="closeStatusModal()">
          {{ t('cancel') }}
        </button>
      </div>
    </div>
  </div>
</section>
