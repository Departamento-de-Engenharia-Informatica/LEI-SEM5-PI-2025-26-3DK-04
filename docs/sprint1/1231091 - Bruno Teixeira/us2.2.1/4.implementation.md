# 4. User Story Implementation Report

---

## 4.1. US_2.2.1 â€“ Create and Update Vessel Types

### 4.2. Description

As a Port Authority Officer, I want to create and update vessel types, so that vessels can be classified consistently and their operational constraints are properly defined.

---

### 4.3. Implementation Details

- **User Interaction & Flow Control**  
  A UI was developed to allow Port Authority Officers to create and update vessel types by entering details such as name, description, capacity, and operational constraints (maximum rows, bays, and tiers).

- **Business Logic Coordination**  
  The `VesselTypesController` manages the vessel type operations and delegates validation, business rule enforcement, and persistence to the application service.

- **Domain Entity Construction**  
  The `VesselType` entity encapsulates the vessel type's core attributes (name, description, capacity, max rows/bays/tiers) and validation logic, ensuring consistency and correctness within the domain. It includes methods for updating individual properties (`ChangeName`, `ChangeDescription`, `ChangeCapacity`, `ChangeOperationalConstraints`) and managing activation status (`MarkAsActive`, `MarkAsInactive`).

- **Persistence**  
  The `IVesselTypeRepository` interface defines methods for saving, updating, retrieving, and searching vessel type data. Its implementation manages persistence in the database, including support for searching by name and description.

- **Validation & Error Handling**  
  Input validation ensures that:
  - All required fields are provided (name, capacity, operational constraints)
  - Names are unique across vessel types
  - Capacity and operational constraint values are positive integers
  - Errors (e.g., duplicate name, invalid values) trigger appropriate `BusinessRuleValidationException` messages to the user

- **Authorization & Security**  
  Role-based access control ensures that only authenticated users with the "Port Authority Officer" role can create or modify vessel types in the system.

- **Data Consistency**  
  All vessel type operations are performed within controlled transactions using `IUnitOfWork.CommitAsync()` to guarantee atomicity. Any failure during validation or persistence results in rollback to maintain database integrity.

---
