@startuml system_sequence_diagram
actor "System User" as User
participant "System" as System

User -> System: Click activation link (with token)
activate System

System -> System: Validate token

alt Token is valid
    System -> System: Request authentication
    System -> User: Request credentials
    User -> System: Provide credentials
    System -> System: Authenticate user via IAM
    
    alt Authentication successful
        System -> System: Verify email matches token
        
        alt Email matches
            System -> System: Activate user account
            System --> User: Display activation success message
        else Email mismatch
            System --> User: Display error message\n"User data mismatch"
        end
    else Authentication failed
        System --> User: Display error message\n"Authentication failed"
    end
else Token is invalid or expired
    System --> User: Display error message\n"Invalid or expired activation link"
end

deactivate System

@enduml
