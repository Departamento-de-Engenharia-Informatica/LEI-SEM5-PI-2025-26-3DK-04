<section class="manage-docks">
  <div class="container">
    <h1>{{ t('manageDocks.title') }}</h1>

    <div>
      <h2>{{ t('manageDocks.listTitle') }}</h2>

      <div class="filters-section">
        <h3>{{ t('manageDocks.filters') }}</h3>
        <div class="filter-group">
          <label>{{ t('manageDocks.filterByName') }}</label>
          <input
            type="text"
            [(ngModel)]="filterName"
            name="filterName"
            placeholder="{{ t('manageDocks.filterByNamePlaceholder') }}"
            (keyup.enter)="applyFilter()"
          />
        </div>
        <div class="filter-buttons">
          <button class="primary" (click)="applyFilter()">{{ t('manageDocks.applyFilter') }}</button>
          <button class="secondary" (click)="clearFilter()">{{ t('manageDocks.clearFilter') }}</button>
        </div>
      </div>

      <button (click)="loadDocks()">{{ t('manageDocks.refresh') }}</button>

      <table *ngIf="docks.length > 0">
        <thead>
        <tr>
          <th>{{ t('manageDocks.name') }}</th>
          <th>{{ t('manageDocks.location') }}</th>
          <th>{{ t('manageDocks.vesselTypes') }}</th>
          <th>{{ t('manageDocks.actions') }}</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let d of docks">
          <td>{{ d.name }}</td>
          <td>{{ d.locationDescription }}</td>
          <td>
              <span *ngFor="let vt of d.allowedVesselTypes; let last = last">
                {{ vt }}<span *ngIf="!last">, </span>
              </span>
          </td>
          <td>
            <button (click)="editDock(d)">{{ t('manageDocks.edit') }}</button>
            <button class="danger" (click)="softDeleteDock(d.id)">{{ t('manageDocks.delete') }}</button>
          </td>
        </tr>
        </tbody>
      </table>

      <p *ngIf="docks.length === 0">{{ t('manageDocks.noDocks') }}</p>
    </div>

    <hr />

    <form (ngSubmit)="saveDock()">
      <h2>{{ editing ? t('manageDocks.editTitle') : t('manageDocks.createTitle') }}</h2>

      <div class="form-group">
        <label>{{ t('manageDocks.name') }}</label>
        <input [(ngModel)]="dockForm.name" name="name" placeholder="{{ t('manageDocks.namePlaceholder') }}" required />
      </div>

      <div class="form-group">
        <label>{{ t('manageDocks.location') }}</label>
        <input [(ngModel)]="dockForm.locationDescription" name="locationDescription" placeholder="{{ t('manageDocks.locationPlaceholder') }}" required />
      </div>

      <div class="form-group">
        <label>{{ t('manageDocks.length') }}</label>
        <input type="number" [(ngModel)]="dockForm.length" name="length" required />
      </div>

      <div class="form-group">
        <label>{{ t('manageDocks.depth') }}</label>
        <input type="number" [(ngModel)]="dockForm.depth" name="depth" required />
      </div>

      <div class="form-group">
        <label>{{ t('manageDocks.maxDraft') }}</label>
        <input type="number" [(ngModel)]="dockForm.maxDraft" name="maxDraft" required />
      </div>

      <div class="form-group">
        <label>{{ t('manageDocks.coordinates') }}</label>
        <input [(ngModel)]="dockForm.coordinates" name="coordinates" required />
      </div>

      <div class="form-group">
        <label>{{ t('manageDocks.vesselTypes') }}</label>
        <div class="vessel-types">
          <div *ngFor="let vt of vesselTypes" class="vessel-type-item">
            <input
              type="checkbox"
              [id]="vt.id"
              [value]="vt.id"
              (change)="onVesselTypeChange($event)"
              [checked]="dockForm.vesselTypeIds.includes(vt.id)"
            />
            <label [for]="vt.id">{{ vt.name }}</label>
          </div>
        </div>
      </div>

      <div class="form-buttons">
        <button type="submit">{{ editing ? t('manageDocks.saveChanges') : t('manageDocks.create') }}</button>
        <button type="button" class="secondary" (click)="resetForm()">{{ t('manageDocks.cancel') }}</button>
      </div>
    </form>
  </div>
</section>
